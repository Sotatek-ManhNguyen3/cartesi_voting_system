# Voting DApp
This is the voting system. User can vote for candidate listed in the system.
This system provides everyone the ability to create their own voting campaign. (Only people deposited to the system can vote)
They can create the campaign with a list of candidates within it.
Anyone can join the campaign to vote, they can only vote for 1 candidate per campaign. Once they have voted, they can not change their selection, and 10 token will be deducted from their account.

All actions users can do:
- Vote
- Create campaign
- Edit campaign
- Delete campaign
- Deposit
- Withdraw

## Requirements

Please refer to the [rollups-examples requirements](https://github.com/cartesi/rollups-examples/tree/main/README.md#requirements).

## Building

To build the application, run the following command:

```shell
docker buildx bake -f docker-bake.hcl -f docker-bake.override.hcl --load
```

## Running

To start the application, execute the following command:

```shell
docker compose up
```

The application can afterwards be shut down with the following command:

```shell
docker compose down -v
```

## Interacting with the application

We can use the rollups-examples [frontend-console](https://github.com/cartesi/rollups-examples/tree/main/frontend-console) application to interact with the DApp.
Ensure that the [application has already been built](https://github.com/cartesi/rollups-examples/tree/main/frontend-console/README.md#building) before using it.

From within the `frontend-console` directory, you can send an input as follows (If you want to deposit to the system):

```shell
yarn start erc20 deposit --amount 100
```

Or send an input as a request to interact with voting system
You can replace this request by another to retrieve the expected result. The list available api is in [list available api](#available-api).

```shell
yarn start input send --payload '{ "action": "LIST_CAMPAIGN", "page": 1, "limit": 10, "type": "ON_GOING" }'
```

The above action is getting all the available campaign in the system.

In order to verify the notices generated by your inputs, run the command:

```shell
yarn start notice list
```

The response should be something like bellow.

```shell
[
  {
    "id": "5",
    "epoch": 0,
    "input": 6,
    "notice": 0,
    "payload": "{\"data\": [{\"id\": 1, \"creator\": \"0x8B39e23A121bAc9221698cD22ae7A6a80D64b1DC\", \"name\": \"Which is the most favorite coin?\", \"description\": \"This is the default campaign of the system.\", \"start_time\": \"2000-01-01 00:00:00\", \"end_time\": \"2099-01-01 00:00:00\", \"winning_candidate_name\": null, \"votes_of_candidate\": null, \"total_vote\": 0}], \"page\": 1, \"limit\": 10, \"total\": 1}"
  }
]
```

This is the list available campaigns. You can get the id of campaign to get the detail information of that campaign.

Example:

```shell
yarn start input send --payload '{ "action": "CAMPAIGN_DETAIL", "campaign_id": 1 }'
```

The output will be something like this:

```shell
connecting to http://localhost:8545
connected to chain 31337
using account "0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266"
sending "{ "action": "CAMPAIGN_DETAIL", "campaign_id": 1 }"
transaction: 0x19a59c2dd8e08d93aa04e3314a084e919cc833a10e29dc06ac3fb95aa740fdae
waiting for confirmation...
input 7 added to epoch 0
Done in 11.38s.
```

Then, you can query the response from your request by this command (The epoch number and input number is in the output of your request):

```shell
yarn start notice list --epoch 0 --input 7
```

The response will be like this:

```shell
[
  {
    "id": "1",
    "epoch": 0,
    "input": 7,
    "notice": 0,
    "payload": "{\"candidates\": [{\"id\": 1, \"name\": \"BTC\", \"avatar\": \"#4A4A4A\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Bitcoin is a decentralized digital currency that can be transferred on the peer-to-peer bitcoin network. Bitcoin transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain. \"}, {\"id\": 2, \"name\": \"ETH\", \"avatar\": \"#F6B63C\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Ethereum is a decentralized, open-source blockchain with smart contract functionality. Ether is the native cryptocurrency of the platform. Among cryptocurrencies, Ether is second only to Bitcoin in market capitalization. Ethereum was conceived in 2013 by programmer Vitalik Buterin. \"}, {\"id\": 3, \"name\": \"USDT\", \"avatar\": \"#F7882B\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Tether, is an asset-backed cryptocurrency stablecoin. It was launched by the company Tether Limited Inc. in 2014. Tether Limited is owned by the Hong Kong-based company iFinex Inc., which also owns the Bitfinex cryptocurrency exchange. \"}, {\"id\": 4, \"name\": \"BNB\", \"avatar\": \"#F35330\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Binance Coin (BNB) is a cryptocurrency that can be used to trade and pay fees on the Binance cryptocurrency exchange. The Binance Exchange is the largest cryptocurrency exchange in the world as of January 2018, facilitating more than 1.4 million transactions per second. \"}, {\"id\": 5, \"name\": \"CTSI\", \"avatar\": \"#B0F5CD\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"CTSI is a utility token that powers the Cartesi network, which aims to solve blockchain scalability and high fees using technologies such as Optimistic Rollups and side-chains. CTSI can be used for staking and fees for processing data on the network. \"}, {\"id\": 6, \"name\": \"DOGE\", \"avatar\": \"#F7F7F7\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Dogecoin is a cryptocurrency created by software engineers Billy Markus and Jackson Palmer, who decided to create a payment system as a joke, making fun of the wild speculation in cryptocurrencies at the time. It is considered both the first meme coin, and, more specifically, the first dog coin. \"}, {\"id\": 7, \"name\": \"SOL\", \"avatar\": \"#7a396d\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"A sol is a type of colloid in which solid particles are suspended in a liquid. The particles in a sol are very small. The colloidal solution displays the Tyndall effect and is stable. Sols may be prepared via condensation or dispersion. \"}, {\"id\": 8, \"name\": \"DOT\", \"avatar\": \"#F4AED8\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Polkadot is a protocol that connects blockchains \\u2014 allowing value and data to be sent across previously incompatible networks (Bitcoin and Ethereum, for example). It's also designed to be fast and scalable. The DOT token is used for staking and governance; it can be bought or sold on Coinbase and other exchanges. \"}, {\"id\": 9, \"name\": \"HEX\", \"avatar\": \"#0156D3\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Hex (HEX) is an Ethereum-based token that is marketed as the first blockchain certificate of deposit. Richard Heart launched Hex in 2019, utilizing an aggressive marketing campaign to build its userbase. Users stake HEX tokens, promising to leave them untouched for specified amounts of time. \"}], \"campaign\": [{\"id\": 1, \"creator\": \"0x8B39e23A121bAc9221698cD22ae7A6a80D64b1DC\", \"name\": \"Which is the most favorite coin?\", \"description\": \"This is the default campaign of the system.\", \"start_time\": \"2000-01-01 00:00:00\", \"end_time\": \"2099-01-01 00:00:00\"}], \"voted\": null}"
  }
]
```

There will be some invalid request, the system will return an error. To get this error, you can query to get the report with the same epoch and input.

Example: When you try to get the candidate you had voted but actually, you didn't vote for that campaign yet:

Command to get the voted candidate

```shell
yarn start input send --payload '{ "action": "VOTED_CANDIDATE", "campaign_id": 1 }'
```

And then you query notice but got nothing, and you take the same input and epoch to query report, you will get the error:

```shell
yarn start report list --epoch 0 --input 8
```

The result will be

```shell
[
  {
    "id": "2",
    "epoch": 0,
    "input": 8,
    "report": 0,
    "payload": "{\"error\": \"You did not vote yet\"}"
  }
]
```

It returns the detail of that campaign and all the candidates in the campaign. If you want to vote, you can use [vote api](#Vote:).
You can explore all the supported actions in [list available api](#available-api)

## Deploying to a testnet

Deploying the application to a blockchain requires creating a smart contract on that network, as well as running a validator node for the DApp.

The first step is to build the DApp's back-end machine, which will produce a hash that serves as a unique identifier.

```shell
docker buildx bake -f docker-bake.hcl -f docker-bake.override.hcl machine --load
```

Once the machine docker image is ready, we can use it to deploy a corresponding Rollups smart contract. This requires you to define a few environment variables to specify which network you are deploying to, which account to use, and which RPC gateway to use when submitting the deploy transaction.

```shell
export NETWORK=<network>
export MNEMONIC=<user sequence of twelve words>
export RPC_URL=<https://your.rpc.gateway>
```

For example, to deploy to the Goerli testnet using an Alchemy RPC node, you could execute:

```shell
export NETWORK=goerli
export MNEMONIC=<user sequence of twelve words>
export RPC_URL=https://eth-goerli.alchemyapi.io/v2/<USER_KEY>
```

With that in place, you can submit a deploy transaction to the Cartesi DApp Factory contract on the target network by executing the following command:

```shell
DAPP_NAME=voting docker compose -f ./deploy-testnet.yml up
```

This will create a file at `./deployments/<network>/voting.address` with the deployed contract's address.
Once the command finishes, it is advisable to stop the docker compose and remove the volumes created when executing it.

```shell
DAPP_NAME=voting docker compose -f ./deploy-testnet.yml down -v
```

After that, a corresponding Cartesi Validator Node must also be instantiated in order to interact with the deployed smart contract on the target network and handle the back-end logic of the DApp.
Aside from the environment variables defined above, the node will also need a secure websocket endpoint for the RPC gateway (WSS URL) and the chain ID of the target network.

For example, for Goerli and Alchemy, you would set the following additional variables:

```shell
export WSS_URL=wss://eth-goerli.alchemyapi.io/v2/<USER_KEY>
export CHAIN_ID=5
```

Then, the node itself can be started by running a docker compose as follows:

```shell
DAPP_NAME=mydapp docker compose -f ./docker-compose-testnet.yml -f ./docker-compose.override.yml up
```

## Interacting with the deployed application

With the node running, you can interact with the deployed DApp using the [frontend-console](https://github.com/cartesi/rollups-examples/tree/main/frontend-console), as described [previously](#interacting-with-the-application).
This time, however, you need to specify the appropriate connectivity configurations.

First of all, in the separate terminal for the frontend-console, define the `MNEMONIC` and `RPC_URL` variables as before:

```shell
export MNEMONIC=<user sequence of twelve words>
export RPC_URL=<https://your.rpc.gateway>
```

Then, inputs can be sent by specifying the DApp contract's address, as follows:

```shell
yarn start input send --payload "Hello there" --addressFile path/to/voting/deployments/<network>/voting.address
```

Resulting notices can then be retrieved by querying the local Cartesi Node, as before:

```shell
yarn start notice list
```

## Running the back-end in host mode

When developing an application, it is often important to easily test and debug it. For that matter, it is possible to run the Cartesi Rollups environment in [host mode](https://github.com/cartesi/rollups-examples/tree/main/README.md#host-mode), so that the DApp's back-end can be executed directly on the host machine, allowing it to be debugged using regular development tools such as an IDE.

This DApp's back-end is written in Python, so to run it in your machine you need to have `python3` installed.

In order to start the back-end, run the following commands in a dedicated terminal:

```shell
python3 -m venv .env
. .env/bin/activate
pip install -r requirements.txt
ROLLUP_HTTP_SERVER_URL="http://127.0.0.1:5004" python3 voting.py
```

The final command will effectively run the back-end and send corresponding outputs to port `5004`.
It can optionally be configured in an IDE to allow interactive debugging using features like breakpoints.

You can also use a tool like [entr](https://eradman.com/entrproject/) to restart the back-end automatically when the code changes. For example:

```shell
ls *.py | ROLLUP_HTTP_SERVER_URL="http://127.0.0.1:5004" entr -r python3 voting.py
```

After the back-end successfully starts, it should print an output like the following:

```log
INFO:__main__:HTTP rollup_server url is http://127.0.0.1:5004
INFO:__main__:Sending finish
```

After that, you can interact with the application normally [as explained above](#interacting-with-the-application).

## Available API

### Deposit to the dapp

Deposit to the dapp to get the right to vote in this system (Only users who deposited to the system can vote)

```shell
yarn start erc20 deposit --amount 100
```

### All the above requests is pass into following command:

```shell
yarn start input send --payload <action_in_string>
```

Example

```shell
yarn start input send --payload '{"action":"LIST_ALL"}'
```

#### 1. Get list campaign

View all the campaigns in the DApp

```shell
{
    "action": "LIST_CAMPAIGN",
    "page": 1,
    "limit": 10,
    "type": "ON_GOING" | "FINISHED" | "VOTED" | "ALL"
}
```

Example response

```shell
[
  {
    "id": "5",
    "epoch": 0,
    "input": 6,
    "notice": 0,
    "payload": "{\"data\": [{\"id\": 1, \"creator\": \"0x8B39e23A121bAc9221698cD22ae7A6a80D64b1DC\", \"name\": \"Which is the most favorite coin?\", \"description\": \"This is the default campaign of the system.\", \"start_time\": \"2000-01-01 00:00:00\", \"end_time\": \"2099-01-01 00:00:00\", \"winning_candidate_name\": null, \"votes_of_candidate\": null, \"total_vote\": 0}], \"page\": 1, \"limit\": 10, \"total\": 1}"
  }
]
```

#### 2. Get campaign detail

View detail of a campaign and list candidate of this campaign<br/>
Return: Campaign info and list candidates.

```shell
{
    "action": "CAMPAIGN_DETAIL",
    "campaign_id": 1
}
```

Example response

```shell
[
  {
    "id": "1",
    "epoch": 0,
    "input": 1,
    "notice": 0,
    "payload": "{\"candidates\": [{\"id\": 1, \"name\": \"BTC\", \"avatar\": \"#4A4A4A\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Bitcoin is a decentralized digital currency that can be transferred on the peer-to-peer bitcoin network. Bitcoin transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain. \"}, {\"id\": 2, \"name\": \"ETH\", \"avatar\": \"#F6B63C\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Ethereum is a decentralized, open-source blockchain with smart contract functionality. Ether is the native cryptocurrency of the platform. Among cryptocurrencies, Ether is second only to Bitcoin in market capitalization. Ethereum was conceived in 2013 by programmer Vitalik Buterin. \"}, {\"id\": 3, \"name\": \"USDT\", \"avatar\": \"#F7882B\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Tether, is an asset-backed cryptocurrency stablecoin. It was launched by the company Tether Limited Inc. in 2014. Tether Limited is owned by the Hong Kong-based company iFinex Inc., which also owns the Bitfinex cryptocurrency exchange. \"}, {\"id\": 4, \"name\": \"BNB\", \"avatar\": \"#F35330\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Binance Coin (BNB) is a cryptocurrency that can be used to trade and pay fees on the Binance cryptocurrency exchange. The Binance Exchange is the largest cryptocurrency exchange in the world as of January 2018, facilitating more than 1.4 million transactions per second. \"}, {\"id\": 5, \"name\": \"CTSI\", \"avatar\": \"#B0F5CD\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"CTSI is a utility token that powers the Cartesi network, which aims to solve blockchain scalability and high fees using technologies such as Optimistic Rollups and side-chains. CTSI can be used for staking and fees for processing data on the network. \"}, {\"id\": 6, \"name\": \"DOGE\", \"avatar\": \"#F7F7F7\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Dogecoin is a cryptocurrency created by software engineers Billy Markus and Jackson Palmer, who decided to create a payment system as a joke, making fun of the wild speculation in cryptocurrencies at the time. It is considered both the first meme coin, and, more specifically, the first dog coin. \"}, {\"id\": 7, \"name\": \"SOL\", \"avatar\": \"#7a396d\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"A sol is a type of colloid in which solid particles are suspended in a liquid. The particles in a sol are very small. The colloidal solution displays the Tyndall effect and is stable. Sols may be prepared via condensation or dispersion. \"}, {\"id\": 8, \"name\": \"DOT\", \"avatar\": \"#F4AED8\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Polkadot is a protocol that connects blockchains \\u2014 allowing value and data to be sent across previously incompatible networks (Bitcoin and Ethereum, for example). It's also designed to be fast and scalable. The DOT token is used for staking and governance; it can be bought or sold on Coinbase and other exchanges. \"}, {\"id\": 9, \"name\": \"HEX\", \"avatar\": \"#0156D3\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Hex (HEX) is an Ethereum-based token that is marketed as the first blockchain certificate of deposit. Richard Heart launched Hex in 2019, utilizing an aggressive marketing campaign to build its userbase. Users stake HEX tokens, promising to leave them untouched for specified amounts of time. \"}], \"campaign\": [{\"id\": 1, \"creator\": \"0x8B39e23A121bAc9221698cD22ae7A6a80D64b1DC\", \"name\": \"Which is the most favorite coin?\", \"description\": \"This is the default campaign of the system.\", \"start_time\": \"2000-01-01 00:00:00\", \"end_time\": \"2099-01-01 00:00:00\"}], \"voted\": null}"
  }
]
```

#### 3. Voted candidate:

View the candidate you voted for in the campaign.<br/>
Return: Voted candidate or error if you haven't voted yet.

```shell
{
    "action": "VOTED_CANDIDATE",
    "campaign_id": 1
}
```

Example response

```shell
[
  {
    "id": "9",
    "epoch": 0,
    "input": 11,
    "notice": 0,
    "payload": "{\"id\": 1, \"candidate_id\": 1, \"campaign_id\": 1, \"user\": \"0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\", \"voting_time\": \"1970-01-01 00:00:40\", \"name\": \"BTC\", \"avatar\": \"#4A4A4A\", \"votes\": 1, \"brief_introduction\": \"Bitcoin is a decentralized digital currency that can be transferred on the peer-to-peer bitcoin network. Bitcoin transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain. \"}"
  }
]
```

#### 4. Vote:

Vote for a candidate.<br/>
Return: Message success or fail.

```shell
{
    "action": "VOTE",
    "candidate_id": 1,
    "campaign_id": 1
}
```

Example response

```shell
[
  {
    "id": "8",
    "epoch": 0,
    "input": 10,
    "notice": 0,
    "payload": "{\"message\": \"Success\"}"
  }
]
```

#### 5. Create campaign:

Create your own campaign.<br/>
Return: Campaign detail or error message

```shell
{
    "action": "CREATE_CAMPAIGN",
    "name": "C1",
    "description": "Create a new conference campaign",
    "start_time": "2022-07-08 12:11:00",
    "end_time": "2023-07-08 12:11:00",
    "candidates": [
        {
            "name": "C1",
            "avatar": "avatar.png",
            "brief_introduction": "Welcome to the C1 campaign"
        },
        {
            "name": "C2",
            "avatar": "avatar.png",
            "brief_introduction": "Welcome to the C1 campaign"
        }
    ]
}
```

Example response

```shell
[
  {
    "id": "10",
    "epoch": 0,
    "input": 14,
    "notice": 0,
    "payload": "{\"message\": \"success\", \"id\": 2, \"campaign\": {\"id\": 2, \"creator\": \"0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\", \"name\": \"C1\", \"description\": \"Create a new conference campaign\", \"start_time\": \"2022-07-08 12:11:00\", \"end_time\": \"2023-07-08 12:11:00\"}}"
  }
]
```

#### 6. Get voting result of campaign

```shell
{
    "action": "RESULT",
    "campaign_id": 1
}
```

Example response

```shell
[
  {
    "id": "13",
    "epoch": 0,
    "input": 18,
    "notice": 0,
    "payload": "{\"total_vote\": 1, \"voted_candidate\": {\"id\": 1, \"candidate_id\": 1, \"campaign_id\": 1, \"user\": \"0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\", \"voting_time\": \"1970-01-01 00:00:40\", \"name\": \"BTC\", \"avatar\": \"#4A4A4A\", \"votes\": 1, \"brief_introduction\": \"Bitcoin is a decentralized digital currency that can be transferred on the peer-to-peer bitcoin network. Bitcoin transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain. \"}, \"campaign\": [{\"id\": 1, \"name\": \"BTC\", \"avatar\": \"#4A4A4A\", \"campaign_id\": 1, \"votes\": 1, \"brief_introduction\": \"Bitcoin is a decentralized digital currency that can be transferred on the peer-to-peer bitcoin network. Bitcoin transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain. \"}, {\"id\": 2, \"name\": \"ETH\", \"avatar\": \"#F6B63C\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Ethereum is a decentralized, open-source blockchain with smart contract functionality. Ether is the native cryptocurrency of the platform. Among cryptocurrencies, Ether is second only to Bitcoin in market capitalization. Ethereum was conceived in 2013 by programmer Vitalik Buterin. \"}, {\"id\": 3, \"name\": \"USDT\", \"avatar\": \"#F7882B\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Tether, is an asset-backed cryptocurrency stablecoin. It was launched by the company Tether Limited Inc. in 2014. Tether Limited is owned by the Hong Kong-based company iFinex Inc., which also owns the Bitfinex cryptocurrency exchange. \"}, {\"id\": 4, \"name\": \"BNB\", \"avatar\": \"#F35330\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Binance Coin (BNB) is a cryptocurrency that can be used to trade and pay fees on the Binance cryptocurrency exchange. The Binance Exchange is the largest cryptocurrency exchange in the world as of January 2018, facilitating more than 1.4 million transactions per second. \"}, {\"id\": 5, \"name\": \"CTSI\", \"avatar\": \"#B0F5CD\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"CTSI is a utility token that powers the Cartesi network, which aims to solve blockchain scalability and high fees using technologies such as Optimistic Rollups and side-chains. CTSI can be used for staking and fees for processing data on the network. \"}, {\"id\": 6, \"name\": \"DOGE\", \"avatar\": \"#F7F7F7\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Dogecoin is a cryptocurrency created by software engineers Billy Markus and Jackson Palmer, who decided to create a payment system as a joke, making fun of the wild speculation in cryptocurrencies at the time. It is considered both the first meme coin, and, more specifically, the first dog coin. \"}, {\"id\": 7, \"name\": \"SOL\", \"avatar\": \"#7a396d\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"A sol is a type of colloid in which solid particles are suspended in a liquid. The particles in a sol are very small. The colloidal solution displays the Tyndall effect and is stable. Sols may be prepared via condensation or dispersion. \"}, {\"id\": 8, \"name\": \"DOT\", \"avatar\": \"#F4AED8\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Polkadot is a protocol that connects blockchains \\u2014 allowing value and data to be sent across previously incompatible networks (Bitcoin and Ethereum, for example). It's also designed to be fast and scalable. The DOT token is used for staking and governance; it can be bought or sold on Coinbase and other exchanges. \"}, {\"id\": 9, \"name\": \"HEX\", \"avatar\": \"#0156D3\", \"campaign_id\": 1, \"votes\": 0, \"brief_introduction\": \"Hex (HEX) is an Ethereum-based token that is marketed as the first blockchain certificate of deposit. Richard Heart launched Hex in 2019, utilizing an aggressive marketing campaign to build its userbase. Users stake HEX tokens, promising to leave them untouched for specified amounts of time. \"}]}"
  }
]
```

#### 7. Edit campaign

```shell
{
    "action": "EDIT_CAMPAIGN",
    "id": 1,
    "name": "C1",
    "description": "Create a new conference campaign",
    "start_time": "2022-07-08 12:11:00",
    "end_time": "2023-07-08 12:11:00",
    "candidates": [
        {
            "name": "C1",
            "avatar": "avatar.png",
            "brief_introduction": "Welcome to the C1 campaign"
        },
        {
            "name": "C2",
            "avatar": "avatar.png",
            "brief_introduction": "Welcome to the C1 campaign"
        }
    ]
}
```

Example response

```shell
[
  {
    "id": "15",
    "epoch": 0,
    "input": 21,
    "notice": 0,
    "payload": "{\"message\": \"Update campaign successfully\"}"
  }
]
```

#### 8. Candidate detail

```shell
{
    "action": "CANDIDATE_DETAIL",
    "campaign_id": 1,
    "candidate_id": 1
}
```

Example response

```shell
[
  {
    "id": "16",
    "epoch": 0,
    "input": 22,
    "notice": 0,
    "payload": "{\"candidate\": {\"id\": 1, \"name\": \"BTC\", \"avatar\": \"#4A4A4A\", \"campaign_id\": 1, \"votes\": 1, \"brief_introduction\": \"Bitcoin is a decentralized digital currency that can be transferred on the peer-to-peer bitcoin network. Bitcoin transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain. \"}}"
  }
]
```

#### 9. Delete campaign

```shell
{
    "action": "DELETE_CAMPAIGN",
    "id": 1
}
```

Example

```shell
[
  {
    "id": "21",
    "epoch": 0,
    "input": 28,
    "notice": 0,
    "payload": "{\"message\": \"Delete campaign successfully\"}"
  }
]
```

#### 10. Deposit info of user

```shell
{
    "action": "DEPOSIT_INFO"
}
```

Example response

```shell
[
  {
    "id": "22",
    "epoch": 0,
    "input": 29,
    "notice": 0,
    "payload": "{\"amount\": 1000, \"used_amount\": 50, \"withdrawn_amount\": 0, \"contract_address\": \"0x610178da211fef7d417bc0e6fed39f05609ad788\"}"
  }
]
```

#### 11. Request withdraw

```shell
{
    "action": "WITHDRAW",
    "amount": "10000000000000000000"
}
```

Example response

```shell
[
  {
    "id": "23",
    "epoch": 0,
    "input": 30,
    "notice": 0,
    "payload": "{\"message\": \"Withdraw money successfully!\"}"
  }
]
```

#### 12. Save executed voucher

```shell
{
    "action": "SAVE_EXECUTED_VOUCHER",
    "id": "1"
}
```

Example response

```shell
[
  {
    "id": "24",
    "epoch": 0,
    "input": 31,
    "notice": 0,
    "payload": "{\"message\": \"Save successfully\"}"
  }
]
```

#### 13. Get list executed voucher

```shell
{
    "action": "LIST_EXECUTED_VOUCHER"
}
```

Example response

```shell
[
  {
    "id": "25",
    "epoch": 0,
    "input": 32,
    "notice": 0,
    "payload": "{\"ids\": [\"1\"]}"
  }
]
```

#### 14. Get history actions

```shell
{
    "action": "ACTION_HISTORY",
    "page": 1,
    "limit": 10,
    "type": "all"
}
```

<table>
<tr>
<th>Action name</th>
<th>Action code</th>
<th>Data save to database</th>
<th>Response for FE</th>
<th>Example sentence for FE</th>
</tr>
<tr>
<td>Create campaign</td>
<td>CREATE_CAMPAIGN</td>
<td>

```shell
campaign: {
  id
  name
}
time
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
```

</td>
<td>

You created campaign *campaign_name* at *time*

</td>
</tr>
<tr>
<td>Vote</td>
<td>VOTE</td>
<td>

```shell
campaign {
    id
    name
}
time
candidate {
    id
    name
}
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
candidate: {
    id: number,
    name: string,
}
time: string
```

</td>
<td>

You voted for candidate *candidate_name* in campaign *campaign_name* at *time*

</td>
</tr>
<tr>
<td>Edit campaign</td>
<td>EDIT_CAMPAIGN</td>
<td>

```shell
campaign {
    id
    name
}
time
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
```

</td>
<td>

You edited info of campaign *campaign_name* at *time*

</td>
</tr>
<tr>
<td>Delete campaign</td>
<td>DELETE_CAMPAIGN</td>
<td>

```shell
campaign {
    id
    name
}
time
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
```

</td>
<td>

You deleted campaing *campaign_name* at *time*

</td>
</tr>
<tr>
<td>Withdraw</td>
<td>WITHDRAW</td>
<td>

```shell
amount: number
time: string
```

</td>
<td>

```shell
amount: number
time: string
```

</td>
<td>

You requested to withdraw *amount* tokens at *time*

</td>
</tr>
<tr>
<td>Execute voucher</td>
<td>EXECUTE_VOUCHER</td>
<td>

```shell
voucher_id: number
amount: number
time: string
```

</td>
<td>

```shell
voucher_id: number
amount: number
time: string
```

</td>
<td>

You executed successfully voucher *voucher_id* with amount *amount* tokens at *time*

</td>
</tr>
<tr>
<td>Deposit</td>
<td>DEPOSIT</td>
<td>

```shell
amount: number
time: string
```

</td>
<td>

```shell
amount: number
time: string
```

</td>
<td>

You deposited to the DApp *amount* tokens at *time*

</td>
</tr>
<tr>
<td>Decrease token</td>
<td>DECREASE_TOKEN</td>
<td>

```shell
amount: number
time: string
reason: string
```

</td>
<td>

```shell
amount: number
time: string
reason: string
```

</td>
<td>

You had been charged *amount* tokens at *time* because *reason*

</td>
</tr>
</table>

#### 15. Get notifications

The DApp will only save 20 earliest notifications of user.

```shell
{
    "action": "NOTIFICATION",
    "page": 1,
    "limit": 10
}
```

<table>
<tr>
<th>Action name</th>
<th>Action code</th>
<th>Data save to database</th>
<th>Response for FE</th>
<th>Example sentence for FE</th>
</tr>
<tr>
<td rowspan="2">Create campaign</td>
<td rowspan="2">CREATE_CAMPAIGN</td>
<td rowspan="2">

```shell
campaign {
    id
    name
}
time
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
type: 'success'
```

</td>
<td>

You created campaign *campaign_name* successfully

</td>
</tr>
<tr>
<td>

```shell
time: string
type: 'error'
error: string
```

</td>
<td>

Create campaign *campaign_name* failed because *error*

</td>
</tr>
<tr>
<td rowspan="2">Vote</td>
<td rowspan="2">VOTE</td>
<td rowspan="2">

```shell
campaign {
    id
    name
}
time
candidate {
    id
    name
}
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
candidate: {
    id: number,
    name: string,
}
time: string
type: 'success'
```

</td>
<td>

You voted for candidate *candidate_name* in campaign *campaign_name* successfully

</td>
</tr>
<tr>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
candidate: {
    id: number,
    name: string,
}
time: string
type: 'error'
```

</td>
<td>

Vote for candidate *candidate_name* in campaign *campaign_name* failed because *error*

</td>
</tr>
<tr>
<td rowspan="2">Edit campaign</td>
<td rowspan="2">EDIT_CAMPAIGN</td>
<td rowspan="2">

```shell
campaign {
    id
    name
}
time
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
type: 'success'
```

</td>
<td>

You edited info of campaign *campaign_name* successfully

</td>
</tr>
<tr>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
type: 'error'
error: string
```

</td>
<td>

Edit campaign *campaign_name* failed because *error*

</td>
</tr>
<tr>
<td rowspan="2">Delete campaign</td>
<td rowspan="2">DELETE_CAMPAIGN</td>
<td rowspan="2">

```shell
campaign {
    id
    name
}
time
```

</td>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
type: 'success'
```

</td>
<td>

You deleted campaing *campaign_name* at *time* successfully

</td>
</tr>
<tr>
<td>

```shell
campaign: {
    id: number,
    name: string,
}
time: string
type: 'error'
error: string
```

</td>
<td>

Delete campaign *campaign_name* failed because *error*

</td>
</tr>
<tr>
<td rowspan="2">Withdraw</td>
<td rowspan="2">WITHDRAW</td>
<td rowspan="2">

```shell
amount: number
time: string
type: 'error'
error?: string
```

</td>
<td>

```shell
amount: number
time: string
type: 'success'
```

</td>
<td>

You requested to withdraw *amount* tokens successfully

</td>
</tr>
<tr>
<td>

```shell
amount: number
time: string
type: 'error'
error: string
```

</td>
<td>

Withdraw *amount* token failed because *error*

</td>
</tr>
<tr>
<td rowspan="2">Deposit</td>
<td rowspan="2">DEPOSIT</td>
<td rowspan="2">

```shell
amount: number
time: string
type: 'error'
error?: string
```

</td>
<td>

```shell
amount: number
time: string
type: 'success'
```

</td>
<td>

You deposited to the DApp *amount* tokens successfully

</td>
</tr>
<tr>
<td>

```shell
amount: number
time: string
type: 'error'
error: string
```

</td>
<td>

Deposit *amount* token to DApp failed because *error*

</td>
</tr>
<tr>
<td>System error</td>
<td>SYSTEM</td>
<td>

```shell
time: string
type: 'error'
error: string
```

</td>
<td>

```shell
time: string
type: 'error'
error: string
```

</td>
<td>

System error: *error*

</td>
</tr>
</table>
